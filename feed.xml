<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.2">Jekyll</generator><link href="https://malingaperera.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://malingaperera.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2023-10-11T09:32:56+00:00</updated><id>https://malingaperera.github.io/feed.xml</id><title type="html">Romesh Malinga Perera</title><subtitle>Human | Engineer | Researcher </subtitle><entry><title type="html">Index Physical Structure Example - Multi-column Non-Clustered Index with Includes</title><link href="https://malingaperera.github.io/index-physical-structure-example-multi-column-non-clustered-index-with-includes/" rel="alternate" type="text/html" title="Index Physical Structure Example - Multi-column Non-Clustered Index with Includes"/><published>2020-07-18T21:01:00+00:00</published><updated>2020-07-18T21:01:00+00:00</updated><id>https://malingaperera.github.io/index-physical-structure-example-multi-column-non-clustered-index-with-includes</id><content type="html" xml:base="https://malingaperera.github.io/index-physical-structure-example-multi-column-non-clustered-index-with-includes/"><![CDATA[<div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/physical_design_example_non_clustered_index_with_includes_1-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/physical_design_example_non_clustered_index_with_includes_1-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/physical_design_example_non_clustered_index_with_includes_1-1400.webp"/> <img src="/assets/img/physical_design_example_non_clustered_index_with_includes_1.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>This article demonstrates the physical design of a multi-column non-clustered index with include-columns. Many examples on the internet only demonstrate the most simple version of an index with a single column. This article gives a proper view of an index with multiple columns through a simple example. Furthermore, you can see how the include-columns are stored, only at the leaf level of the tree.</p> <p>Here we use a simple table ‘People’ with 6 columns (ID, First Name, Last Name, Age, Sex, Address). We assume we already have a clustered index created on the ID column (it will be almost no difference if there is no clustered index as well, explained at the end). Now we are going to create the non-clustered index as defined below.</p> <p><code> CREATE NONCLUSTERED INDEX IX_NAME ON People <br/> (FirstName, LastName)<br/> INCLUDE (Age, Sex)<br/> GO<br/> </code></p> <p>Below diagram shows the structure of this non-clustered index.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/physical_design_example_non_clustered_index_with_includes-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/physical_design_example_non_clustered_index_with_includes-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/physical_design_example_non_clustered_index_with_includes-1400.webp"/> <img src="/assets/img/physical_design_example_non_clustered_index_with_includes.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> Index Physical Structure Example; Multi-column Non-Clustered Index with Includes. </div> <p>In the example above we are searching for the name <b>“Malinga Perera”</b>. In the root level (level 2; note that, the level number starts from leaves) <b>‘Malinga’</b> should come after <b>‘Kain’</b> and before <b>‘Ophelia’</b>. So we go to page 583. In level 1 we see that (Malinga) ‘Perera’ should come between (Malinga) <b>‘Amad’</b> and (Malinga) <b>‘Sonu’</b>. So we move to page 1024, which is a leaf node. In this leaf node, we find <b>‘Malinga Perera’</b>. I had to add a lot of ‘Malinga’s to get the last name into the example :D.</p> <p>In the leaf level, we see the additional columns we added as include-columns. Include-columns have a lesser overhead compared to the index-columns. However, if we need anything else, like address, we have to go to the actual table (clustered index). We got clustered index key 17 from this leaf node. This should lead us to the full data row directly (through the clustered index, to be specific). If we had this non-clustered index on a heap (i.e. no clustered index) then the pointer will give us the RID (row ID). RID directly give the physical address of the data (file:page:row).</p>]]></content><author><name></name></author><category term="database"/><category term="indices"/><category term="multi-column"/><category term="non-clustered"/><category term="database"/><category term="physical-design-structure"/><summary type="html"><![CDATA[Index Physical Structure Example; Multi-column Non-Clustered Index with Includes]]></summary></entry><entry><title type="html">PostgreSQL – How to get the total index size used by each table in a database</title><link href="https://malingaperera.github.io/postgresql-how-to-get-the-total-index-size-used-by-each-table-in-a-database/" rel="alternate" type="text/html" title="PostgreSQL – How to get the total index size used by each table in a database"/><published>2020-01-15T21:01:00+00:00</published><updated>2020-01-15T21:01:00+00:00</updated><id>https://malingaperera.github.io/postgresql-how-to-get-the-total-index-size-used-by-each-table-in-a-database</id><content type="html" xml:base="https://malingaperera.github.io/postgresql-how-to-get-the-total-index-size-used-by-each-table-in-a-database/"><![CDATA[<div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/postgresql-how-to-get-the-total-index-size-used-by-each-table-in-a-database/postgresql-how-to-get-the-total-index-size-used-by-each-table-in-a-database-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/postgresql-how-to-get-the-total-index-size-used-by-each-table-in-a-database/postgresql-how-to-get-the-total-index-size-used-by-each-table-in-a-database-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/postgresql-how-to-get-the-total-index-size-used-by-each-table-in-a-database/postgresql-how-to-get-the-total-index-size-used-by-each-table-in-a-database-1400.webp"/> <img src="/assets/img/postgresql-how-to-get-the-total-index-size-used-by-each-table-in-a-database/postgresql-how-to-get-the-total-index-size-used-by-each-table-in-a-database.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>As per the documentation, To get the total size of all indexes attached to a table, you use the function. The pg_indexes_size() function accepts the OID or table name as the argument and returns the total disk space used by all indexes attached to that table.</p> <p>We will use this funcion to get the index sizes of each table in the database.</p> <p><code> select relname as table_name, <br/> pg_size_pretty(pg_indexes_size(relid)) as index_size <br/> from pg_catalog.pg_statio_user_tables; <br/> </code></p>]]></content><author><name></name></author><category term="database"/><category term="indices"/><category term="postgresql"/><summary type="html"><![CDATA[PostgreSQL – How to get the total index size used by each table in a database]]></summary></entry></feed>