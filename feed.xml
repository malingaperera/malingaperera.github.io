<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.2">Jekyll</generator><link href="https://malingaperera.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://malingaperera.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2023-10-22T00:55:12+00:00</updated><id>https://malingaperera.github.io/feed.xml</id><title type="html">Romesh Malinga Perera</title><subtitle>Human | Engineer | Researcher </subtitle><entry><title type="html">VS Code Won’t Open After Unplanned Restart (Failed to deserialize the V8 snapshot blob)</title><link href="https://malingaperera.github.io/vs-code-wont-open-after-unplanned-restart-failed-to-deserialize-the-v8-snapshot-blob/" rel="alternate" type="text/html" title="VS Code Won’t Open After Unplanned Restart (Failed to deserialize the V8 snapshot blob)"/><published>2021-02-11T21:01:00+00:00</published><updated>2021-02-11T21:01:00+00:00</updated><id>https://malingaperera.github.io/vs-code-wont-open-after-unplanned-restart-failed-to-deserialize-the-v8-snapshot-blob</id><content type="html" xml:base="https://malingaperera.github.io/vs-code-wont-open-after-unplanned-restart-failed-to-deserialize-the-v8-snapshot-blob/"><![CDATA[<div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/vs_code_wont_open/vs_code_wont_open-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/vs_code_wont_open/vs_code_wont_open-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/vs_code_wont_open/vs_code_wont_open-1400.webp"/> <img src="/assets/img/vs_code_wont_open/vs_code_wont_open.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>The visual studio was running fine in my machine till an unplanned restart happened. Soon after restart VS didn’t open giving me the below error. I reinstalled the Visual Studio Code without uninstalling which fixed the issue. In addition, it started without any loss to previous plugins and open projects. Error</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Fatal error in , line 0
Failed to deserialize the V8 snapshot blob. This can mean that the snapshot blob file is corrupted or missing.
FailureMessage Object: 00000071D3DFF2C0
1: 00007FF60A57E91F node::Buffer::New+130911
2: 00007FF60A3F7CDA IsSandboxedProcess+1850986
3: 00007FF608E1D798 v8::Isolate::Initialize+744
4: 00007FF60A3FD1A0 uv_mutex_unlock+21184
5: 00007FF607A28793 std::__1::__vector_base &gt;::__end_cap+102515
6: 00007FF607AE56C8 v8::internal::JSMemberBase::JSMemberBase+54872
7: 00007FF6079513A0 Ordinal0+5024
8: 00007FF60D6FDB02 uv_random+18066594
9: 00007FFB77EF4034 BaseThreadInitThunk+20
10: 00007FFB781F3691 RtlUserThreadStart+33
</code></pre></div></div>]]></content><author><name></name></author><category term="programming"/><category term="coding"/><category term="programming"/><category term="tools"/><summary type="html"><![CDATA[VS Code Won’t Open After Unplanned Restart (Failed to deserialize the V8 snapshot blob)]]></summary></entry><entry><title type="html">NetworkX visualization with Graphviz (Example)</title><link href="https://malingaperera.github.io/networkx-visualization-with-graphviz-example/" rel="alternate" type="text/html" title="NetworkX visualization with Graphviz (Example)"/><published>2020-07-19T21:01:00+00:00</published><updated>2020-07-19T21:01:00+00:00</updated><id>https://malingaperera.github.io/networkx-visualization-with-graphviz-example</id><content type="html" xml:base="https://malingaperera.github.io/networkx-visualization-with-graphviz-example/"><![CDATA[<div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/networkx-visualization-with-graphviz-example/NetworkX_visualization_with_Graphviz_Example_thumb-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/networkx-visualization-with-graphviz-example/NetworkX_visualization_with_Graphviz_Example_thumb-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/networkx-visualization-with-graphviz-example/NetworkX_visualization_with_Graphviz_Example_thumb-1400.webp"/> <img src="/assets/img/networkx-visualization-with-graphviz-example/NetworkX_visualization_with_Graphviz_Example_thumb.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>If you are trying to visualize a nice graph with NetworkX, you should be exhausted by now. After all, NetworkX only provides basic functionality for graph visualization. The main goal of NetworkX is to enable graph analysis. For everything other than basic visualization, it’s advisable to use a separate specialized library. In my case, I choose Graphviz. It’s simplistic to get an attractive visualization of a NetworkX graph with Graphviz. I’m taking a gradual start, but you may skip to <strong>“NetworkX with Graphviz”</strong> directly.</p> <p><br/></p> <h3 id="networkx-with-matplotlib">NetworkX with Matplotlib</h3> <p>Let’s start small, so we can see the issue here. I’m trying to plot a simple directed graph (more like a tree).</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import networkx as nx
import matplotlib.pyplot as plt

G = nx.DiGraph()
G.add_edges_from([('A', 'B'), ('A', 'C'), ('A', 'D'), ('E', 'D'), ('D', 'F'), ('E', 'C'), ('E', 'G'), ('B', 'H'), ('H', 'F')])
pos = nx.spring_layout(G)
nx.draw_networkx(G, pos)
plt.show()
</code></pre></div></div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/networkx-visualization-with-graphviz-example/NetworkX_visualization_with_Graphviz_Example_2-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/networkx-visualization-with-graphviz-example/NetworkX_visualization_with_Graphviz_Example_2-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/networkx-visualization-with-graphviz-example/NetworkX_visualization_with_Graphviz_Example_2-1400.webp"/> <img src="/assets/img/networkx-visualization-with-graphviz-example/NetworkX_visualization_with_Graphviz_Example_2.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>The main issue I had here was the layout. When the number of nodes increases, the layout becomes messy. And the none of the limited set of layouts seems to be working. So the first option is to use a graphviz layout without much change.</p> <p><br/></p> <h3 id="using-graphviz-layout-with-the-existing-plot">Using Graphviz layout with the existing plot</h3> <p>Here we are just trying to get a better layout without any change to the graph look and feel. Note that you need to install the Graphviz before going to next step. (download). With Windows, you can download the setup from the above page. For Ubuntu, you can easily install that with below command (Graphviz and some needed libraries)</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo apt-get install graphviz libgraphviz-dev pkg-config
</code></pre></div></div> <p>Then we use the Graphviz layout (I use the default one here) to generate the positions of the nodes. Here I have exported it as a png, rather than showing it.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pos = nx.nx_pydot.graphviz_layout(G)
nx.draw_networkx(G, pos)
plt.savefig('networkx_graph.png')
</code></pre></div></div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/networkx-visualization-with-graphviz-example/NetworkX_visualization_with_Graphviz_Example_1-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/networkx-visualization-with-graphviz-example/NetworkX_visualization_with_Graphviz_Example_1-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/networkx-visualization-with-graphviz-example/NetworkX_visualization_with_Graphviz_Example_1-1400.webp"/> <img src="/assets/img/networkx-visualization-with-graphviz-example/NetworkX_visualization_with_Graphviz_Example_1.png" class="img-fluid rounded z-depth-2" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>As you can see the layout already looks better. However if you want to take the full advantage/power of Graphviz, you need to convert this to a Graphviz graph.</p> <p><br/></p> <h3 id="networkx-with-graphviz">NetworkX with Graphviz</h3> <p>We can directly convert to a Graphviz graph. First, install pygraphviz. Then run the code.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip install pygraphviz
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>A = nx.nx_agraph.to_agraph(G)
A.layout()
A.draw('networkx_graph.png')
</code></pre></div></div> <p>You can use an intermediate dot file, if you are working with 2 applications or if you want to store the graph structure.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nx.drawing.nx_pydot.write_dot(p_graph, 'networkx_graph.png')
gv.render('dot', 'png', 'networkx_graph.png')
</code></pre></div></div> <p>Both of these will generate the following graph. You can do any modification as you wish (Documentation).</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/networkx-visualization-with-graphviz-example/NetworkX_visualization_with_Graphviz_Example_3-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/networkx-visualization-with-graphviz-example/NetworkX_visualization_with_Graphviz_Example_3-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/networkx-visualization-with-graphviz-example/NetworkX_visualization_with_Graphviz_Example_3-1400.webp"/> <img src="/assets/img/networkx-visualization-with-graphviz-example/NetworkX_visualization_with_Graphviz_Example_3.png" class="img-fluid rounded z-depth-3" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div>]]></content><author><name></name></author><category term="visualization"/><category term="graph"/><summary type="html"><![CDATA[NetworkX visualization with Graphviz (Example)]]></summary></entry><entry><title type="html">Index Physical Structure Example - Multi-column Non-Clustered Index with Includes</title><link href="https://malingaperera.github.io/index-physical-structure-example-multi-column-non-clustered-index-with-includes/" rel="alternate" type="text/html" title="Index Physical Structure Example - Multi-column Non-Clustered Index with Includes"/><published>2020-07-18T21:01:00+00:00</published><updated>2020-07-18T21:01:00+00:00</updated><id>https://malingaperera.github.io/index-physical-structure-example-multi-column-non-clustered-index-with-includes</id><content type="html" xml:base="https://malingaperera.github.io/index-physical-structure-example-multi-column-non-clustered-index-with-includes/"><![CDATA[<div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/physical_design_example_non_clustered_index_with_includes/physical_design_example_non_clustered_index_with_includes_1-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/physical_design_example_non_clustered_index_with_includes/physical_design_example_non_clustered_index_with_includes_1-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/physical_design_example_non_clustered_index_with_includes/physical_design_example_non_clustered_index_with_includes_1-1400.webp"/> <img src="/assets/img/physical_design_example_non_clustered_index_with_includes/physical_design_example_non_clustered_index_with_includes_1.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>This article demonstrates the physical design of a multi-column non-clustered index with include-columns. Many examples on the internet only demonstrate the most simple version of an index with a single column. This article gives a proper view of an index with multiple columns through a simple example. Furthermore, you can see how the include-columns are stored, only at the leaf level of the tree.</p> <p>Here we use a simple table ‘People’ with 6 columns (ID, First Name, Last Name, Age, Sex, Address). We assume we already have a clustered index created on the ID column (it will be almost no difference if there is no clustered index as well, explained at the end). Now we are going to create the non-clustered index as defined below.</p> <p><code> CREATE NONCLUSTERED INDEX IX_NAME ON People <br/> (FirstName, LastName)<br/> INCLUDE (Age, Sex)<br/> GO<br/> </code></p> <p>Below diagram shows the structure of this non-clustered index.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/physical_design_example_non_clustered_index_with_includes/physical_design_example_non_clustered_index_with_includes-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/physical_design_example_non_clustered_index_with_includes/physical_design_example_non_clustered_index_with_includes-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/physical_design_example_non_clustered_index_with_includes/physical_design_example_non_clustered_index_with_includes-1400.webp"/> <img src="/assets/img/physical_design_example_non_clustered_index_with_includes/physical_design_example_non_clustered_index_with_includes.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> Index Physical Structure Example; Multi-column Non-Clustered Index with Includes. </div> <p>In the example above we are searching for the name <b>“Malinga Perera”</b>. In the root level (level 2; note that, the level number starts from leaves) <b>‘Malinga’</b> should come after <b>‘Kain’</b> and before <b>‘Ophelia’</b>. So we go to page 583. In level 1 we see that (Malinga) ‘Perera’ should come between (Malinga) <b>‘Amad’</b> and (Malinga) <b>‘Sonu’</b>. So we move to page 1024, which is a leaf node. In this leaf node, we find <b>‘Malinga Perera’</b>. I had to add a lot of ‘Malinga’s to get the last name into the example :D.</p> <p>In the leaf level, we see the additional columns we added as include-columns. Include-columns have a lesser overhead compared to the index-columns. However, if we need anything else, like address, we have to go to the actual table (clustered index). We got clustered index key 17 from this leaf node. This should lead us to the full data row directly (through the clustered index, to be specific). If we had this non-clustered index on a heap (i.e. no clustered index) then the pointer will give us the RID (row ID). RID directly give the physical address of the data (file:page:row).</p>]]></content><author><name></name></author><category term="database"/><category term="indices"/><category term="multi-column"/><category term="non-clustered"/><category term="database"/><category term="physical-design-structure"/><summary type="html"><![CDATA[Index Physical Structure Example; Multi-column Non-Clustered Index with Includes]]></summary></entry><entry><title type="html">Jaro–Winkler Similarity – How to correctly count the number of transpositions</title><link href="https://malingaperera.github.io/jaro-winkler-similarity-how-to-correctly-count-the-number-of-transpositions/" rel="alternate" type="text/html" title="Jaro–Winkler Similarity – How to correctly count the number of transpositions"/><published>2020-01-15T21:01:00+00:00</published><updated>2020-01-15T21:01:00+00:00</updated><id>https://malingaperera.github.io/jaro%E2%80%93winkler-similarity%E2%80%93how-to-correctly-count-the-number-of-transpositions</id><content type="html" xml:base="https://malingaperera.github.io/jaro-winkler-similarity-how-to-correctly-count-the-number-of-transpositions/"><![CDATA[<div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/jaro_winkler_distance/jaro_winkler_distance-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/jaro_winkler_distance/jaro_winkler_distance-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/jaro_winkler_distance/jaro_winkler_distance-1400.webp"/> <img src="/assets/img/jaro_winkler_distance/jaro_winkler_distance.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>Jaro–Winkler Similarity is a widely used similarity measure for checking the similarity between two strings. Being a similarity measure (not a distance measure), a higher value means more similar strings. You can read on basics and how it works on Wikipedia. It’s available in many places and I’m not going into that. However, none of these sites talks about how to correctly count the number of transpositions in complex situations.</p> <p>Transposition is defined as “matches which are not in the same position”. For a simple example like <strong>‘cart’</strong> vs <strong>‘cratec’</strong> it is obvious with 4 matches and 2 transpositions (‘r’ and ‘a’ are in not in the same position). But for <strong>‘xabcdxxxxxx’</strong> vs <strong>‘yaybycydyyyyyy’</strong> in the first look, all letters seem to be out of position but there are <strong>no transpositions</strong> (4 matches). For very similar <strong>‘xabcdxxxxxx’</strong> vs <strong>‘ydyaybycyyyyyy’</strong>, there are <strong>4 transpositions</strong> (4 matches). With these examples, it might not be trivial to count the number of transpositions.</p> <p>The main reason behind this complexity is we are looking at the whole word whereas we should be looking only at the matched part.</p> <p>Ex: <strong>‘xabcdxxxxxx’, ‘yaybycydyyyyyy’</strong> (get the matching letters and write it down)</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'xabcdxxxxxx': abcd'
yaybycydyyyyyy': abcd
</code></pre></div></div> <p>Now it’s clear that there are no transpositions</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'xabcdxxxxxx': abcd
' ydyaybycyyyyyy': dabc
</code></pre></div></div> <p>After extracting the matching letters, you can see each letter can be given an index. In the first word a-0, b-1, c-2, d-4. In the second word d-0, a-1, b-2, c-3. What you must check is how many of the matches are not having the same index. In this case, none of the matching letters has the same index. So, there are 4 transpositions. Once you understand this, it’s very trivial.</p> <p>You can find code for Jaro-Winkler here: https://rosettacode.org/wiki/Jaro_distance. You can use it to check if your calculations are correct.</p>]]></content><author><name></name></author><category term="algorithms"/><category term="algorithms"/><summary type="html"><![CDATA[Jaro–Winkler Similarity – How to correctly count the number of transpositions]]></summary></entry><entry><title type="html">PostgreSQL – How to get the total index size used by each table in a database</title><link href="https://malingaperera.github.io/postgresql-how-to-get-the-total-index-size-used-by-each-table-in-a-database/" rel="alternate" type="text/html" title="PostgreSQL – How to get the total index size used by each table in a database"/><published>2020-01-15T21:01:00+00:00</published><updated>2020-01-15T21:01:00+00:00</updated><id>https://malingaperera.github.io/postgresql-how-to-get-the-total-index-size-used-by-each-table-in-a-database</id><content type="html" xml:base="https://malingaperera.github.io/postgresql-how-to-get-the-total-index-size-used-by-each-table-in-a-database/"><![CDATA[<div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/postgresql-how-to-get-the-total-index-size-used-by-each-table-in-a-database/postgresql-how-to-get-the-total-index-size-used-by-each-table-in-a-database-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/postgresql-how-to-get-the-total-index-size-used-by-each-table-in-a-database/postgresql-how-to-get-the-total-index-size-used-by-each-table-in-a-database-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/postgresql-how-to-get-the-total-index-size-used-by-each-table-in-a-database/postgresql-how-to-get-the-total-index-size-used-by-each-table-in-a-database-1400.webp"/> <img src="/assets/img/postgresql-how-to-get-the-total-index-size-used-by-each-table-in-a-database/postgresql-how-to-get-the-total-index-size-used-by-each-table-in-a-database.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>As per the documentation, To get the total size of all indexes attached to a table, you use the function. The pg_indexes_size() function accepts the OID or table name as the argument and returns the total disk space used by all indexes attached to that table.</p> <p>We will use this funcion to get the index sizes of each table in the database.</p> <p><code> select relname as table_name, <br/> pg_size_pretty(pg_indexes_size(relid)) as index_size <br/> from pg_catalog.pg_statio_user_tables; <br/> </code></p>]]></content><author><name></name></author><category term="database"/><category term="indices"/><category term="postgresql"/><summary type="html"><![CDATA[PostgreSQL – How to get the total index size used by each table in a database]]></summary></entry><entry><title type="html">Redis Sorted Object Set (Sorted Hashes)</title><link href="https://malingaperera.github.io/redis-sorted-object-set-sorted-hashes/" rel="alternate" type="text/html" title="Redis Sorted Object Set (Sorted Hashes)"/><published>2016-04-04T21:01:00+00:00</published><updated>2016-04-04T21:01:00+00:00</updated><id>https://malingaperera.github.io/redis-sorted-object-set-sorted-hashes</id><content type="html" xml:base="https://malingaperera.github.io/redis-sorted-object-set-sorted-hashes/"><![CDATA[<div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/redis-sorted-object-set-sorted-hashes/redis-sorted-object-set-sorted-hashes1-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/redis-sorted-object-set-sorted-hashes/redis-sorted-object-set-sorted-hashes1-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/redis-sorted-object-set-sorted-hashes/redis-sorted-object-set-sorted-hashes1-1400.webp"/> <img src="/assets/img/redis-sorted-object-set-sorted-hashes/redis-sorted-object-set-sorted-hashes1.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>We all know that the best way to store objects in Redis is through, Redis hashes. Redis sorted sets are used to keep a sorted set with a given score for each value. What if we need a sorted set of objects? What we need is a <strong>“Sorted set of Objects”</strong>, which Redis does not support by default. We came up with a hybrid, simple data structure that allows sorted objects using <strong>Redis Hashes</strong> and <strong>Redis Sorted sets</strong>.</p> <p><br/></p> <h3 id="use-of-redis-hashes">Use of Redis Hashes</h3> <p>Here we will keep an object as a Redis hash. Think of a simple object with several values as shown below.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TICKET1 {     
    MERCHANT_ID: 0123456789,     
    TIME_STAMP: 00000000000,     
    SALE: 12.32 
}
</code></pre></div></div> <p>This will be saved in the Redis</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HMSET TICKET1 MERCHANT_ID "0123456789" TIME_STAMP "00000000000" SALE "12.32"
</code></pre></div></div> <p>When we need to edit an existing value and add a new value it can be done below</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// Adding a new value
HSET TICKET1 DISCOUNT "0.60"
 
// Set Multiple Values
HMSET TICKET1 DISCOUNT "0.50" SALE "12.60"
 
// Set single Value
HSET TICKET1 SALE "12.50"
 
// RESULT
TICKET1 {
    MERCHANT_ID: 0123456789,
    TIME_STAMP: 00000000000,
    SALE: 12.50,
    DISCOUNT: 0.50
}
</code></pre></div></div> <p>Getting full map and some selected value</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// Get the full object
HGETALL TICKET1

1) "MERCHANT_ID" 
2) "0123456789" 
3) "TIME_STAMP" 
4) "00000000000" 
...   

// Get set of selected subset of values 
HMGET TICKET1 MERCHANT_ID SALE   
1) "0123456789" 
2) "12.50"   

// get a single value 
HGET DISCOUNT   
1) "0.50"
</code></pre></div></div> <p>Whole map or items can be deleted</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// Delete one field
HDEL TICKET1 SALE
 
// Delete whole object
DEL TICKET1
</code></pre></div></div> <p>There is some more commands in the Redis hash that can help us in this process</p> <table> <thead> <tr> <th>Command</th> <th>Action</th> </tr> </thead> <tbody> <tr> <td>HEXISTS</td> <td>Check for item</td> </tr> <tr> <td>HINCRBY</td> <td>Add to integer value</td> </tr> <tr> <td>HINCRBYFLOAT</td> <td>Add to float value</td> </tr> <tr> <td>HKEYS</td> <td>Return all keys</td> </tr> <tr> <td>HLEN</td> <td>Get number of items</td> </tr> <tr> <td>HSCAN</td> <td>Iterate items</td> </tr> <tr> <td>HSETNX</td> <td>Set item if doesn’t exist</td> </tr> <tr> <td>HVALS</td> <td>Return all values</td> </tr> </tbody> </table> <p><br/></p> <h3 id="use-of-redis-sorted-sets">Use of Redis Sorted Sets</h3> <p>As we said above we need to search with time values and in-order searches. This cannot be done alone by Redis hashes. Here we keep a list of all keys in the Redis hashes as a sorted set. This allow us to get all the maps that came after some time stamp. or between two time stamps. Other than that this allows us to search under topics (EX: get all TICKETS after 00000001 time stamp)</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ZADD TICKETS 1459746182 "TICKET1"
ZADD TICKETLINES 1459746192 "TICKETLINE1"
ZADD TICKETLINES 1459746222 "TICKETLINE2"
ZADD TICKETS 1459746282 "TICKET2"
ZADD TICKETS 1459746382 "TICKET3"
</code></pre></div></div> <p>Get items under one topic within a given time range</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ZRANGE TICKETS 1459746282 -1
1) "TICKET2"
2) "TICKET3"
</code></pre></div></div> <p>There is some more commands in the Redis hash that can help us in this process</p> <table> <thead> <tr> <th>Command</th> <th>Action</th> </tr> </thead> <tbody> <tr> <td>ZCARD</td> <td>Get number of items</td> </tr> <tr> <td>ZCOUNT</td> <td>Number of items within score range</td> </tr> <tr> <td>ZINCRBY</td> <td>Add to score</td> </tr> <tr> <td>ZLEXCOUNT</td> <td>Lexicographical range count</td> </tr> <tr> <td>ZRANGE</td> <td>Get items within rank range</td> </tr> <tr> <td>ZLEXRANGE</td> <td>Get items within lexicographical range</td> </tr> <tr> <td>ZRANGEBYSCORE</td> <td>Get items within score range</td> </tr> <tr> <td>ZRANK</td> <td>Get item rank</td> </tr> <tr> <td>ZREM</td> <td>Remove item(s)</td> </tr> <tr> <td>ZREMRANGEBYLEX</td> <td>Remove items within lexicographical range</td> </tr> <tr> <td>ZREMRANGEBYRANK</td> <td>Remove items within rank range</td> </tr> <tr> <td>ZREMRANGEBYSCORE</td> <td>Remove items within score range</td> </tr> <tr> <td>ZREVRANGE</td> <td>ZRANGE in reverse order</td> </tr> <tr> <td>ZREVRANGEBYSCORE</td> <td>ZRANGEBYSCORE in reverse order</td> </tr> <tr> <td>ZREVRANK</td> <td>ZRANK in reverse order</td> </tr> <tr> <td>ZSCAN</td> <td>Iterate items</td> </tr> <tr> <td>ZSCORE</td> <td>Get item score</td> </tr> <tr> <td>ZUNIONSTORE</td> <td>Store union</td> </tr> </tbody> </table>]]></content><author><name></name></author><category term="database"/><category term="redis"/><category term="cache"/><category term="key-value"/><summary type="html"><![CDATA[Redis Sorted Object Set (Sorted Hashes)]]></summary></entry></feed>